---
title: 'pycoQC, interactive quality control for Oxford Nanopore Sequencing '
tags:
  - python3
  - plots
  - metrics
  - nanopore 
  - interactive
authors:
  - name: Adrien Leger
    orcid: 0000-0001-8772-6776
    affiliation: 1
  -name: Tommaso Leonardi
    orcid: 0000-0002-4449-1863
    affiliation: 2
affiliations:
 - name: EMBL EBI, Hinxton, Cambridgeshire
   index: 1
 - name: Gurdon Institute, Cambridge, Cambridgeshire
   index: 2
date: 08 November 2018
bibliography: paper.bib
---

# Summary

Nanopore sequencing of nucleic acids has rapidly developped and is now firmly established as a reliable alternative to sequencing by synthesis methods [@deamer_three_2016]. Oxford Nanopore Technologies (ONT) released the first commercial nanopore sequencing device in 2014 and has continually improved the technology since then [jain_oxford_2016]. Among other advantages ONT technology allows very long reads, real time  sequencing, direct sequencing of RNA molecules and detection of modified bases.

The raw signal acquired by the array of nanopores is stored in hdf5 format, at the rate of one file (called fast5) per molecule sequenced. The signal is then converted to a nucleic acid sequence using a basecalling software. There are several alternatives, but the best performers for read accuracy are Albacore and Guppy develloped and maintained by ONT [@ryan_wick_comparison_2018]. Both software can generate fastq files, fast5 files containing basecalling information and a text summary file. However, ONT does not provide any streamline quality control software to evaluate in depth the quality of the sequencing run.

Here we present pycoQC a new tool to generate interactive quality control metrics and plots from basecalled nanopore reads or from the summary file generated by Albacore and Guppy. Although there are other open source alternatives such as Nanoplot [@de_coster_nanopack:_2018], MinionQC [@lanfear_minionqc:_2018] and toulligQC [@berengere_laffay_post_2018], pycoQC has several unique features:

* Integration with [plotly](https://plot.ly/python/) python charting library to create dynamic D4.js data visualizations.
* Extensive python API developed for interactive data exploration in Jupyter Notebook ([example notebook](https://a-slide.github.io/pycoQC/pycoQC_usage.html)).
* Generation of a customizable interactive HTML report through a simple command line interface ([example report](https://a-slide.github.io/pycoQC/pycoQC_Albacore-2.1.10_basecall-1D-DNA.htmll)).
* Multiprocessing Fast5 feature extraction program to generate a summary file directly from Fast5 files if not available.
* Support for data generated by ONT Minion, Gridion and Promethion devices basecalled by Albacore 1.3+  Guppy 2.1.3+ and MinKNOW 18.12+ (which uses Guppy internally).

Briefly, pycoQC import, filter and preprocess a summary file generated by one of the previously mentioned basecallers or with the companion program `Fast5_to_seq_summary` provided with the package. Then, a range of plots and tables can be generated to explore the data (**Figure 1**)



**Example plots + description**

# Availability

pycoQC is available at https://github.com/a-slide/pycoQC together with and extensive documentation. The source code has been archived to Zenodo with the linked DOI: [10.5281/zenodo.2540931](https://zenodo.org/record/2540931)

# Acknowledgements

The authors would like to thank Paulo Amaral, who generated most of the datasets used to test pycoQC as well as Tomas Fitzgerald, Jack Monahan and Michael Clark who beta-tested the package and suggested new features. In addition we would also like to thanks Kim Judge for providing us with  extra summary sequencing files. A.L is funded by the ERC Cofund Marie Curie program T.L is funded by .... 

# References